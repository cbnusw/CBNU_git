(this.webpackJsonp=this.webpackJsonp||[]).push([[220],{2443:function(e,t,n){n(105),e.exports=n(2496)},2496:function(e,t,n){"use strict";n.r(t);n(145),n(18),n(64);var r=n(0),a=n.n(r),o=(n(321),n(14)),i=n(32),c=n(1),s=n(88),u=(n(78),n(40),n(46),n(36),n(41),n(11));function l(e){var t=e.dataset.url;return u.a.get(t).then((function(t){var n=t.data;return function(e,t){e.textContent=t,e.classList.remove("hidden")}(e,n.count)})).catch((function(e){console.error("Failed to fetch search count from '".concat(t,"'."),e)}))}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r=a()(".js-search-group-dropdown"),u=a()(".js-search-project-dropdown");this.searchInput=".js-search-input",this.searchClear=".js-search-clear",this.groupId=r.data("groupId"),this.eventListeners(),n=Array.from(document.querySelectorAll(".js-search-count")),Promise.all(n.map(l)),r.glDropdown({selectable:!0,filterable:!0,filterRemote:!0,fieldName:"group_id",search:{fields:["full_name"]},data:function(e,t){return i.a.groups(e,{},(function(e){return e.unshift({full_name:Object(c.a)("Any")}),e.splice(1,0,{type:"divider"}),t(e)}))},id:function(e){return e.id},text:function(e){return e.full_name},clicked:function(){return e.submitSearch()}}),u.glDropdown({selectable:!0,filterable:!0,filterRemote:!0,fieldName:"project_id",search:{fields:["name"]},data:function(e,n){t.getProjectsData(e).then((function(e){return e.unshift({name_with_namespace:Object(c.a)("Any")}),e.splice(1,0,{type:"divider"}),e})).then((function(e){return n(e)})).catch((function(){return new o.a(Object(c.a)("Error fetching projects"))}))},id:function(e){return e.id},text:function(e){return e.name_with_namespace},clicked:function(){return e.submitSearch()}}),s.a.initRefSwitcher()}var t,n,r;return t=e,r=[{key:"submitSearch",value:function(){return a()(".js-search-form").submit()}}],(n=[{key:"eventListeners",value:function(){a()(document).off("keyup",this.searchInput).on("keyup",this.searchInput,this.searchKeyUp),a()(document).off("click",this.searchClear).on("click",this.searchClear,this.clearSearchField.bind(this))}},{key:"searchKeyUp",value:function(){""===a()(this).val()?a()(".js-search-clear").addClass("hidden"):a()(".js-search-clear").removeClass("hidden")}},{key:"clearSearchField",value:function(){return a()(this.searchInput).val("").trigger("keyup").focus()}},{key:"getProjectsData",value:function(e){var t=this;return new Promise((function(n){t.groupId?i.a.groupProjects(t.groupId,e,{},n):i.a.projects(e,{order_by:"id"},n)}))}}])&&d(t.prototype,n),r&&d(t,r),e}();document.addEventListener("DOMContentLoaded",(function(){return new h}))},73:function(e,t,n){"use strict";n(30),n(35),n(18),n(64);var r=n(0),a=n.n(r),o=n(32),i=(n(65),n(69),n(55),n(67),n(71));function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.projectSelectInput=a()(t),this.newItemBtn=a()(".new-project-item-link"),this.resourceType=this.newItemBtn.data("type"),this.resourceLabel=this.newItemBtn.data("label"),this.formattedText=this.deriveTextVariants(),this.groupId=this.projectSelectInput.data("groupId"),this.bindEvents(),this.initLocalStorage()}var t,r,o;return t=e,(r=[{key:"bindEvents",value:function(){var e=this;this.projectSelectInput.siblings(".new-project-item-select-button").on("click",(function(t){return e.openDropdown(t)})),this.newItemBtn.on("click",(function(t){e.getProjectFromLocalStorage()||(t.preventDefault(),e.openDropdown(t))})),this.projectSelectInput.on("change",(function(){return e.selectProject()}))}},{key:"initLocalStorage",value:function(){i.a.isLocalStorageAccessSafe()&&(this.localStorageKey=["group",this.groupId,this.formattedText.localStorageItemType,"recent-project"].join("-"),this.setBtnTextFromLocalStorage())}},{key:"openDropdown",value:function(e){n.e(239).then(n.t.bind(null,428,7)).then((function(){a()(e.currentTarget).siblings(".project-item-select").select2("open")})).catch((function(){}))}},{key:"selectProject",value:function(){var e=JSON.parse(this.projectSelectInput.val()),t={url:"".concat(e.url,"/").concat(this.projectSelectInput.data("relativePath")),name:e.name};this.setNewItemBtnAttributes(t),this.setProjectInLocalStorage(t)}},{key:"setBtnTextFromLocalStorage",value:function(){var e=this.getProjectFromLocalStorage();this.setNewItemBtnAttributes(e)}},{key:"setNewItemBtnAttributes",value:function(e){e?(this.newItemBtn.attr("href",e.url),this.newItemBtn.text("".concat(this.formattedText.defaultTextPrefix," in ").concat(e.name))):this.newItemBtn.text("Select project to create ".concat(this.formattedText.presetTextSuffix))}},{key:"getProjectFromLocalStorage",value:function(){var e=localStorage.getItem(this.localStorageKey);return JSON.parse(e)}},{key:"setProjectInLocalStorage",value:function(e){var t=JSON.stringify(e);localStorage.setItem(this.localStorageKey,t)}},{key:"deriveTextVariants",value:function(){var e=this.resourceLabel;return{localStorageItemType:"new-".concat(this.resourceType.split("_").join("-").slice(0,-1)),defaultTextPrefix:e,presetTextSuffix:this.resourceType.split("_").join(" ").slice(0,-1)}}}])&&c(t.prototype,r),o&&c(t,o),e}(),u=n(1),l=function(){a()(".ajax-project-select").each((function(e,t){var n,r=this,i=a()(t).data("simpleFilter")||!1,c=a()(t).data("select2");return this.groupId=a()(t).data("groupId"),this.userId=a()(t).data("userId"),this.includeGroups=a()(t).data("includeGroups"),this.allProjects=a()(t).data("allProjects")||!1,this.orderBy=a()(t).data("orderBy")||"id",this.withIssuesEnabled=a()(t).data("withIssuesEnabled"),this.withMergeRequestsEnabled=a()(t).data("withMergeRequestsEnabled"),this.withShared=void 0===a()(t).data("withShared")||a()(t).data("withShared"),this.includeProjectsInSubgroups=a()(t).data("includeProjectsInSubgroups")||!1,this.allowClear=a()(t).data("allowClear")||!1,n=Object(u.d)("ProjectSelect|Search for project"),this.includeGroups&&(n+=Object(u.d)("ProjectSelect| or group")),a()(t).select2({placeholder:n,minimumInputLength:0,query:function(e){var t,n=function(t){var n={results:t};return e.callback(n)};return t=r.includeGroups?function(t){return o.a.groups(e.term,{},(function(e){var r=e.concat(t);return n(r)}))}:n,r.groupId?o.a.groupProjects(r.groupId,e.term,{with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,with_shared:r.withShared,include_subgroups:r.includeProjectsInSubgroups},t):r.userId?o.a.userProjects(r.userId,e.term,{with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,with_shared:r.withShared,include_subgroups:r.includeProjectsInSubgroups},t):o.a.projects(e.term,{order_by:r.orderBy,with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,membership:!r.allProjects},t)},id:function(e){return i?e.id:JSON.stringify({name:e.name,url:e.web_url})},text:function(e){return e.name_with_namespace||e.name},initSelection:function(e,t){return o.a.project(e.val()).then((function(e){var n=e.data;return t(n)}))},allowClear:this.allowClear,dropdownCssClass:"ajax-project-dropdown"}),c||i?t:new s(t)}))};t.a=function(){return n.e(239).then(n.t.bind(null,428,7)).then(l).catch((function(){}))}},88:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(42),n(89);var r=n(0),a=n.n(r),o=n(51),i=n.n(o),c=n(1),s=n(33);n(28),n(78),n(40),n(46),n(129),n(35),n(77),n(18),n(36),n(41);var u=function(e){return e.reduce((function(e,t){var n=t.name,r=t.value;return Object.assign(e,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,r))}),{})},l=n(11),d=n(14),h=n(73);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=a()("ul.clone-options-dropdown"),n=a()("#project_clone"),r=a()(".js-git-clone-holder .js-clone-dropdown-label"),o=document.querySelector(".js-mobile-git-clone .js-clone-dropdown-label"),c=r.text().trim();c.length>0&&a()("a:contains('".concat(c,"')"),t).addClass("is-active"),a()("a",t).on("click",(function(e){e.preventDefault();var r=a()(e.currentTarget),i=r.attr("href"),c=r.data("cloneType");a()(".is-active",t).removeClass("is-active"),a()('a[data-clone-type="'.concat(c,'"]')).each((function(){var e=a()(this),t=e.find(".dropdown-menu-inner-title").text(),n=e.closest(".project-clone-holder").find(".js-clone-dropdown-label");e.toggleClass("is-active"),n.text(t)})),o?o.dataset.clipboardText=i:n.val(i),a()(".js-git-empty .js-clone").text(i)})),e.initRefSwitcher(),a()(".project-refs-select").on("change",(function(){return a()(this).parents("form").submit()})),a()(".hide-no-ssh-message").on("click",(function(e){return i.a.set("hide_no_ssh_message","false"),a()(this).parents(".no-ssh-key-message").remove(),e.preventDefault()})),a()(".hide-no-password-message").on("click",(function(e){return i.a.set("hide_no_password_message","false"),a()(this).parents(".no-password-message").remove(),e.preventDefault()})),a()(".hide-auto-devops-implicitly-enabled-banner").on("click",(function(e){var t=a()(this).data("project-id"),n="hide_auto_devops_implicitly_enabled_banner_".concat(t);return i.a.set(n,"false"),a()(this).parents(".auto-devops-implicitly-enabled-banner").remove(),e.preventDefault()})),e.projectSelectDropdown()}var t,n,r;return t=e,r=[{key:"projectSelectDropdown",value:function(){Object(h.a)(),a()(".project-item-select").on("click",(function(t){return e.changeProject(a()(t.currentTarget).val())}))}},{key:"changeProject",value:function(e){return window.location=e}},{key:"initRefSwitcher",value:function(){var e=document.createElement("li"),t=document.createElement("a");return t.href="#",a()(".js-project-refs-dropdown").each((function(){var n,r,o,i=a()(this),h=i.data("selected"),f=i.data("fieldName"),p=Boolean(i.data("visit")),m=i.closest("form"),v=m.attr("action"),g=Object(s.h)((n=m[0],r=new FormData(n),o=Array.from(r.keys()).map((function(e){var t=r.getAll(e);return{name:e,value:1===(t=t.filter((function(e){return e}))).length?t[0]:t}})),u(o)),v);return i.glDropdown({data:function(e,t){l.a.get(i.data("refsUrl"),{params:{ref:i.data("ref"),search:e}}).then((function(e){var n=e.data;return t(n)})).catch((function(){return Object(d.a)(Object(c.a)("An error occurred while getting projects"))}))},selectable:!0,filterable:!0,filterRemote:!0,filterByText:!0,inputFieldName:i.data("inputFieldName"),fieldName:f,renderRow:function(n){var r,a,o,i=e.cloneNode(!1),c=t.cloneNode(!1);return n===h&&(c.className="is-active"),c.textContent=n,c.dataset.ref=n,n.length>0&&p&&(c.href=Object(s.h)((o=n,(a=f)in(r={})?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r),g)),i.appendChild(c),i},id:function(e,t){return t.attr("data-ref")},toggleLabel:function(e,t){return t.text().trim()},clicked:function(e){var t=e.e;p||t.preventDefault()}})}))}}],(n=null)&&f(t.prototype,n),r&&f(t,r),e}()}},[[2443,1,0]]]);
//# sourceMappingURL=pages.search.show.02399312.chunk.js.map