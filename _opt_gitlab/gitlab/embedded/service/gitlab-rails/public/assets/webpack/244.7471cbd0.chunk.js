(this.webpackJsonp=this.webpackJsonp||[]).push([[244],{3244:function(t,e,n){"use strict";n.r(e);var i=n(17),o=n(22),r=(n(30),n(129),n(32));n(24),n(49),n(56),n(42),n(78),n(40),n(1063),n(18),n(68),n(36),n(1064),n(1065),n(1066),n(1067),n(1068),n(1069),n(1070),n(1071),n(1072),n(1073),n(1074),n(1075),n(1076),n(41);function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s,c=new Map,l=function(){return c.get("current")},u={setInitialData:function(t,e){(0,t.commit)("SET_INITIAL_DATA",e)},requestDataError:function(t){(0,t.commit)("REQUEST_DATA_ERROR")},fetchData:function(t){var e=t.commit,n=t.dispatch,i=t.state;e("REQUEST_DATA"),r.a.lsifData(i.projectPath,i.commitId,[i.blobPath]).then((function(t){var n=t.data[i.blobPath].reduce((function(t,e){return e.hover&&(t["".concat(e.start_line,":").concat(e.start_char)]=e,function(t){var e=0,n=a(document.getElementById("LC".concat(t.start_line+1)).childNodes).find((function(n){var i=n.textContent;return e===t.start_char||(e+=i.length,!1)}));n&&(n.setAttribute("data-char-index",t.start_char),n.setAttribute("data-line-index",t.start_line),n.classList.add("cursor-pointer","code-navigation","js-code-navigation"))}(e)),t}),{});e("REQUEST_DATA_SUCCESS",n)})).catch((function(){return n("requestDataError")}))},showDefinition:function(t,e){var n,i,o=t.commit,r=t.state,a=e.target;if(r.data){var s=a.classList.contains("hll");if(l()&&l().classList.remove("hll"),a.classList.contains("js-code-navigation")&&!s){var u=a.dataset,f=u.lineIndex,d=u.charIndex;i={x:a.offsetLeft,y:a.offsetTop,height:a.offsetHeight},n=r.data["".concat(f,":").concat(d)],a.classList.add("hll"),function(t){c.set("current",t)}(a)}o("SET_CURRENT_DEFINITION",{definition:n,position:i})}}};function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d,h=(f(s={},"SET_INITIAL_DATA",(function(t,e){var n=e.projectPath,i=e.commitId,o=e.blobPath;t.projectPath=n,t.commitId=i,t.blobPath=o})),f(s,"REQUEST_DATA",(function(t){t.loading=!0})),f(s,"REQUEST_DATA_SUCCESS",(function(t,e){t.loading=!1,t.data=e})),f(s,"REQUEST_DATA_ERROR",(function(t){t.loading=!1})),f(s,"SET_CURRENT_DEFINITION",(function(t,e){var n=e.definition,i=e.position;t.currentDefinition=n,t.currentDefinitionPosition=i})),s),p=new o.b.Store({actions:u,mutations:h,state:{projectPath:null,commitId:null,blobPath:null,loading:!1,data:null,currentDefinition:null,currentDefinitionPosition:null}}),b=(n(28),n(26),n(50),n(58),n(38),n(27),{components:{GlButton:n(553).a},props:{position:{type:Object,required:!0},data:{type:Object,required:!0}},data:function(){return{offsetLeft:0}},computed:{positionStyles:function(){return{left:"".concat(this.position.x-this.offsetLeft,"px"),top:"".concat(this.position.y+this.position.height,"px")}}},watch:{position:{handler:function(){var t=this;this.$nextTick((function(){return t.updateOffsetLeft()}))},deep:!0,immediate:!0}},methods:{updateOffsetLeft:function(){this.offsetLeft=Math.max(0,this.$el.offsetLeft+this.$el.offsetWidth-window.innerWidth+20)}},colorScheme:null===(d=gon)||void 0===d?void 0:d.user_color_scheme}),v=n(4);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E={components:{Popover:Object(v.a)(b,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popover code-navigation-popover popover-font-size-normal gl-popover bs-popover-bottom show",style:t.positionStyles},[n("div",{staticClass:"arrow",style:{left:t.offsetLeft+"px"}}),t._v(" "),t._l(t.data.hover,(function(e,i){return n("div",{key:i,staticClass:"border-bottom"},[e.language?n("pre",{ref:"code-output",refInFor:!0,staticClass:"border-0 bg-transparent m-0 code highlight",class:t.$options.colorScheme,domProps:{innerHTML:t._s(e.value)}}):n("p",{ref:"doc-output",refInFor:!0,staticClass:"p-3 m-0"},[t._v("\n      "+t._s(e.value)+"\n    ")])])})),t._v(" "),t.data.definition_url?n("div",{staticClass:"popover-body"},[n("gl-button",{staticClass:"w-100",attrs:{href:t.data.definition_url,target:"_blank",variant:"default"}},[t._v("\n      "+t._s(t.__("Go to definition"))+"\n    ")])],1):t._e()],2)}),[],!1,null,null,null).exports},computed:_({},Object(o.e)(["currentDefinition","currentDefinitionPosition"])),mounted:function(){this.blobViewer=document.querySelector(".blob-viewer"),this.addGlobalEventListeners(),this.fetchData()},beforeDestroy:function(){this.removeGlobalEventListeners()},methods:_({},Object(o.c)(["fetchData","showDefinition"]),{addGlobalEventListeners:function(){this.blobViewer&&this.blobViewer.addEventListener("click",this.showDefinition)},removeGlobalEventListeners:function(){this.blobViewer&&this.blobViewer.removeEventListener("click",this.showDefinition)}})},D=Object(v.a)(E,(function(){var t=this.$createElement,e=this._self._c||t;return this.currentDefinition?e("popover",{attrs:{position:this.currentDefinitionPosition,data:this.currentDefinition}}):this._e()}),[],!1,null,null,null).exports;i.default.use(o.b);e.default=function(){var t=document.getElementById("js-code-navigation");return p.dispatch("setInitialData",t.dataset),new i.default({el:t,store:p,render:function(t){return t(D)}})}}}]);
//# sourceMappingURL=244.7471cbd0.chunk.js.map