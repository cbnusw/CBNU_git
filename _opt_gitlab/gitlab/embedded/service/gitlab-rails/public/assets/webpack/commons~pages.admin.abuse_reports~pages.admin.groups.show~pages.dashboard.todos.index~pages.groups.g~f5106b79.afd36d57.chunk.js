(this.webpackJsonp=this.webpackJsonp||[]).push([[8],{121:function(e,t,a){"use strict";a(28),a(26),a(85),a(27);function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store={columns:3,issues:[],issuesCount:!1,selectedIssues:[],showAddIssuesModal:!1,activeTab:"all",selectedList:null,searchTerm:"",loading:!1,loadingNewPage:!1,filterLoading:!1,page:1,perPage:50,filter:{path:""}}}var t,a,n;return t=e,(a=[{key:"selectedCount",value:function(){return this.getSelectedIssues().length}},{key:"toggleIssue",value:function(e){var t=e,a=t.selected;t.selected=!a,a?this.removeSelectedIssue(t):this.addSelectedIssue(t)}},{key:"toggleAll",value:function(){var e=this,t=this.selectedCount()!==this.store.issues.length;this.store.issues.forEach((function(a){var s=a;s.selected!==t&&(s.selected=t,t?e.addSelectedIssue(a):e.removeSelectedIssue(a))}))}},{key:"getSelectedIssues",value:function(){return this.store.selectedIssues.filter((function(e){return e.selected}))}},{key:"addSelectedIssue",value:function(e){-1===this.selectedIssueIndex(e)&&this.store.selectedIssues.push(e)}},{key:"removeSelectedIssue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];("all"===this.store.activeTab||t)&&(this.store.selectedIssues=this.store.selectedIssues.filter((function(t){return t.id!==e.id})))}},{key:"purgeUnselectedIssues",value:function(){var e=this;this.store.selectedIssues.forEach((function(t){t.selected||e.removeSelectedIssue(t,!0)}))}},{key:"selectedIssueIndex",value:function(e){return this.store.selectedIssues.indexOf(e)}},{key:"findSelectedIssue",value:function(e){return this.store.selectedIssues.filter((function(t){return t.id===e.id}))[0]}}])&&s(t.prototype,a),n&&s(t,n),e}();t.a=new n},248:function(e,t,a){"use strict";a(24),a(49),a(56),a(30),a(28),a(42),a(26),a(85),a(40),a(46),a(69),a(145),a(35),a(18),a(64),a(55),a(36),a(283),a(91),a(89),a(27),a(41);var s=a(0),n=a.n(s),r=a(20),i=a.n(r),l=a(11),u=a(1),o=a(121),d=a(16);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var s=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=n()(t||".js-user-search");this.users=this.users.bind(this),this.user=this.user.bind(this),this.usersPath="/autocomplete/users.json",this.userPath="/autocomplete/users/:id.json",null!=e&&("object"===c(e)?this.currentUser=e:this.currentUser=JSON.parse(e));var m=r.handleClick,v=this;f.each((function(e,t){var a=s,r={},c=n()(t);r.projectId=c.data("projectId"),r.groupId=c.data("groupId"),r.showCurrentUser=c.data("currentUser"),r.todoFilter=c.data("todoFilter"),r.todoStateFilter=c.data("todoStateFilter"),r.iid=c.data("iid"),r.issuableType=c.data("issuableType");var f=c.data("nullUser"),v=c.data("nullUserDefault"),p=c.data("showMenuAbove"),h=c.data("anyUser"),g=c.data("firstUser");r.authorId=c.data("authorId");var b,y,I,S=c.data("defaultLabel"),w=c.data("issueUpdate"),j=c.closest(".selectbox"),U=j.closest(".block"),_=c.data("abilityName"),k=U.find(".value"),C=U.find(".sidebar-collapsed-user"),x=U.find(".block-loading").fadeOut(),O=v&&f?0:null,N=c.data("selected");void 0===N&&(N=O);var D=function(){var e=c.closest(".selectbox").find("input[name='".concat(c.data("fieldName"),"'][value=0]"));e&&e.remove();var t=c.data("currentUserInfo")||{},s=a.currentUser||{},n=c.data("fieldName"),r=t.name,l=t.id||s.id,u=i.a.template('\n        <input type="hidden" name="<%- fieldName %>"\n          data-meta="<%- userName %>"\n          value="<%- userId %>" />\n        ')({fieldName:n,userName:r,userId:l});j?c.parent().before(u):c.after(u)};U[0]&&U[0].addEventListener("assignYourself",D);var A=function(){return j.find('input[name="'.concat(c.data("fieldName"),'"]'))},T=function(){return A().map((function(e,t){return parseInt(t.value,10)})).get()},E=function(){var e=c.data("maxSelect");if(e){var t=T();if(t.length>e){var a=t[0];c.closest(".selectbox").find("input[name='".concat(c.data("fieldName"),"'][value=").concat(a,"]")).remove(),emitSidebarEvent("sidebar.removeAssignee",{id:a})}}},L=function(e,t){var a=T().filter((function(e){return 0!==e})),s=A().map((function(e,t){return{name:t.dataset.meta,value:parseInt(t.value,10)}})).filter((function(e){return 0!==e.id})).get(0);if(0===a.length)return Object(u.d)("UsersSelect|Unassigned");if(1===a.length)return s.name;if(t){var n=a.filter((function(t){return t!==e.id}));return Object(u.e)(Object(u.d)("UsersSelect|%{name} + %{length} more"),{name:e.name,length:n.length})}return Object(u.e)(Object(u.d)("UsersSelect|%{name} + %{length} more"),{name:s.name,length:a.length-1})};return n()(".assign-to-me-link").on("click",(function(e){if(e.preventDefault(),n()(e.currentTarget).hide(),c.data("multiSelect")){D(),E();var t=c.data("currentUserInfo");c.find(".dropdown-toggle-text").text(L(t)).removeClass("is-default")}else{var a=n()('input[name="'.concat(c.data("fieldName"),'"]'));a.val(gon.current_user_id),N=a.val(),c.find(".dropdown-toggle-text").text(gon.current_user_fullname).removeClass("is-default")}})),U.on("click",".js-assign-yourself",(function(e){return e.preventDefault(),b(a.currentUser.id)})),b=function(e){var t={};return t[_]={},t[_].assignee_id=null!=e?e:null,x.removeClass("hidden").fadeIn(),c.trigger("loading.gl.dropdown"),l.a.put(w,t).then((function(e){var t=e.data,a={},s=a.name;return c.trigger("loaded.gl.dropdown"),x.fadeOut(),t.assignee?(a={name:t.assignee.name,username:t.assignee.username,avatar:t.assignee.avatar_url},s=i.a.escape(a.name)):(a={name:Object(u.d)("UsersSelect|Unassigned"),username:"",avatar:""},s=Object(u.d)("UsersSelect|Assignee")),k.html(y(a)),C.attr("title",s).tooltip("_fixTitle"),C.html(I(a))}))},I=i.a.template('<% if( avatar ) { %> <a class="author-link" href="/<%- username %>"> <img width="24" class="avatar avatar-inline s24" alt="" src="<%- avatar %>"> </a> <% } else { %> <i class="fa fa-user"></i> <% } %>'),y=i.a.template('<% if (username) { %> <a class="author-link bold" href="/<%- username %>"> <% if( avatar ) { %> <img width="32" class="avatar avatar-inline s32" alt="" src="<%- avatar %>"> <% } %> <span class="author"><%- name %></span> <span class="username"> @<%- username %> </span> </a> <% } else { %> <span class="no-value assign-yourself">\n      '.concat(Object(u.e)(Object(u.d)("UsersSelect|No assignee - %{openingTag} assign yourself %{closingTag}"),{openingTag:'<a href="#" class="js-assign-yourself">',closingTag:"</a>"}),"</span> <% } %>")),c.glDropdown({showMenuAbove:p,data:function(e,t){var s=this;return a.users(e,r,(function(a){(s.instance||s.options.instance).options.processData(e,a,t)}))},processData:function(e,t,a){var s,n,r,l,o,m,v=t;if(c.hasClass("js-multiselect")&&0===e.length){var b=A(),y=i.a.uniq(b,!1,(function(e){return e.value})).filter((function(e){var t=parseInt(e.value,10);return!v.find((function(e){return e.id===t}))&&0!==t})).map((function(e){var t=parseInt(e.value,10),a=e.dataset,s=a.avatarUrl,n=a.avatar_url,r=a.name,i=a.username,l=a.canMerge;return{avatar_url:s||n,id:t,name:r,username:i,can_merge:Object(d.F)(l)}}));v=t.concat(y)}if(0===e.length){if(m=0,g)for(n=0,r=v.length;n<r;n+=1)if((o=v[n]).username===g){v.splice(n,1),v.unshift(o);break}if(f&&(m+=1,v.unshift({beforeDivider:!0,name:Object(u.d)("UsersSelect|Unassigned"),id:0})),h&&(m+=1,!0===(l=h)&&(l=Object(u.d)("UsersSelect|Any User")),s={beforeDivider:!0,name:l,id:null},v.unshift(s)),m&&v.splice(m,0,{type:"divider"}),c.hasClass("js-multiselect")){var I=T().filter((function(e){return 0!==e}));if(I.length>0){c.data("dropdownHeader")&&(m+=1,v.splice(m,0,{type:"header",content:c.data("dropdownHeader")}));var S=v.filter((function(e){return-1!==I.indexOf(e.id)})).sort((function(e,t){return e.name>t.name}));v=v.filter((function(e){return-1===I.indexOf(e.id)})),S.forEach((function(e){m+=1,v.splice(m,0,e)})),v.splice(m+1,0,{type:"divider"})}}}a(v),p&&c.data("glDropdown").positionMenuAbove()},filterable:!0,filterRemote:!0,search:{fields:["name","username"]},selectable:!0,fieldName:c.data("fieldName"),toggleLabel:function(e,t,a){var s=a.filterInput.val();if(this.multiSelect&&""===s){var r=a.filteredFullData(),i=a.parseData.bind(a);this.processData(s,r,i)}return this.multiSelect?L(e,n()(t).hasClass("is-active")):e&&"id"in e&&n()(t).hasClass("is-active")?(c.find(".dropdown-toggle-text").removeClass("is-default"),e.text?e.text:e.name):(c.find(".dropdown-toggle-text").addClass("is-default"),S)},defaultLabel:S,hidden:function(){c.hasClass("js-multiselect")&&emitSidebarEvent("sidebar.saveAssignees"),c.data("alwaysShowSelectbox")||(j.hide(),U=j.closest(".block"),(k=U.find(".value")).css("display",""))},multiSelect:c.hasClass("js-multiselect"),inputMeta:c.data("inputMeta"),clicked:function(e){var t=e.$el,a=e.e,s=e.isMarking,r=e.selectedObj;if(t.tooltip("dispose"),c.hasClass("js-multiselect")){var i=t.hasClass("is-active"),l=c.closest(".selectbox").find("input[name='".concat(c.data("fieldName"),"'][value!=0]"));if(E(),r.beforeDivider&&"unassigned"===r.name.toLowerCase())l.each((function(e,t){t.remove()})),emitSidebarEvent("sidebar.removeAllAssignees");else if(i){emitSidebarEvent("sidebar.addAssignee",r);var u=c.closest(".selectbox").find("input[name='".concat(c.data("fieldName"),"'][value=0]"));u&&u.remove()}else 0===l.length&&this.addInput(c.data("fieldName"),0,{}),emitSidebarEvent("sidebar.removeAssignee",r);T().find((function(e){return e===gon.current_user_id}))?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}var d=n()("body").attr("data-page"),f="projects:issues:index"===d,v=d==d&&"projects:merge_requests:index"===d;if(c.hasClass("js-filter-bulk-update")||c.hasClass("js-issuable-form-dropdown")){a.preventDefault();var p=r.id!==N;(N=p?r.id:O)===gon.current_user_id?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}else{if(t.closest(".add-issues-modal").length)o.a.store.filter[c.data("fieldName")]=r.id;else if(m)a.preventDefault(),m(r,s);else{if(c.hasClass("js-filter-submit")&&(f||v))return Issuable.filterResults(c.closest("form"));if(c.hasClass("js-filter-submit"))return c.closest("form").submit();if(!c.hasClass("js-multiselect")){var h=c.closest(".selectbox").find("input[name='".concat(c.data("fieldName"),"']")).val();return b(h)}}c.data("maxSelect")&&T().length===c.data("maxSelect")&&c.dropdown("toggle")}},id:function(e){return e.id},opened:function(e){var t=n()(e.currentTarget),a=T();function s(e){t.find('li[data-user-id="'.concat(e,'"] .dropdown-menu-user-link')).addClass("is-active")}c.hasClass("js-issue-board-sidebar")&&0===a.length&&this.addInput(c.data("fieldName"),0,{}),t.find(".is-active").removeClass("is-active"),a.length>0?T().forEach((function(e){return s(e)})):c.hasClass("js-issue-board-sidebar")?s(0):s(N)},updateLabel:c.data("dropdownTitle"),renderRow:function(e){var t=e.username?"@".concat(e.username):"",s=e.avatar_url?e.avatar_url:gon.default_avatar_url,n=!1;if(this.multiSelect){n=T().find((function(t){return e.id===t}));var l=this.fieldName;c.closest(".selectbox").find("input[name='".concat(l,"'][value='").concat(e.id,"']")).length&&(n=!0)}else n=e.id===N;var u="";return null!=e.beforeDivider?"<li><a href='#' class='".concat(!0===n?"is-active":"","'>").concat(i.a.escape(e.name),"</a></li>"):u="<img src='".concat(s,"' class='avatar avatar-inline m-0' width='32' />"),a.renderRow(r.issuableType,e,n,t,u)}})})),a.e(239).then(a.t.bind(null,428,7)).then((function(){n()(".ajax-users-select").each((function(e,t){var a={};a.skipLdap=n()(t).hasClass("skip_ldap"),a.projectId=n()(t).data("projectId"),a.groupId=n()(t).data("groupId"),a.showCurrentUser=n()(t).data("currentUser"),a.authorId=n()(t).data("authorId"),a.skipUsers=n()(t).data("skipUsers");var s=n()(t).data("nullUser"),r=n()(t).data("anyUser"),i=n()(t).data("emailUser"),l=n()(t).data("firstUser");return n()(t).select2({placeholder:Object(u.a)("Search for a user"),multiple:n()(t).hasClass("multiselect"),minimumInputLength:0,query:function(e){return v.users(e.term,a,(function(t){var a,n={results:t};if(0===e.term.length){if(l)for(var o=n.results,d=0,c=o.length;d<c;d+=1){var f=o[d];if(f.username===l){n.results.splice(d,1),n.results.unshift(f);break}}if(s){var m={name:Object(u.d)("UsersSelect|Unassigned"),id:0};n.results.unshift(m)}if(r){!0===(a=r)&&(a=Object(u.d)("UsersSelect|Any User"));var v={name:a,id:null};n.results.unshift(v)}}if(i&&0===n.results.length&&e.term.match(/^[^@]+@[^@]+$/)){var p=e.term.trim(),h={name:Object(u.e)(Object(u.a)('Invite "%{trimmed}" by email'),{trimmed:p}),username:p,id:p,invite:!0};n.results.unshift(h)}return e.callback(n)}))},initSelection:function(){var e=1<=arguments.length?[].slice.call(arguments,0):[];return v.initSelection.apply(v,e)},formatResult:function(){var e=1<=arguments.length?[].slice.call(arguments,0):[];return v.formatResult.apply(v,e)},formatSelection:function(){var e=1<=arguments.length?[].slice.call(arguments,0):[];return v.formatSelection.apply(v,e)},dropdownCssClass:"ajax-users-dropdown",escapeMarkup:function(e){return e}})}))})).catch((function(){}))}window.emitSidebarEvent=window.emitSidebarEvent||n.a.noop,f.prototype.initSelection=function(e,t){var a=n()(e).val();return"0"===a?t({name:Object(u.d)("UsersSelect|Unassigned")}):""!==a?this.user(a,t):void 0},f.prototype.formatResult=function(e){var t=gon.default_avatar_url;return e.avatar_url&&(t=e.avatar_url),"\n    <div class='user-result'>\n      <div class='user-image'>\n        <img class='avatar avatar-inline s32' src='".concat(t,"'>\n      </div>\n      <div class='user-info'>\n        <div class='user-name dropdown-menu-user-full-name'>\n          ").concat(i.a.escape(e.name),"\n        </div>\n        <div class='user-username dropdown-menu-user-username text-secondary'>\n          ").concat(e.invite?"":"@".concat(i.a.escape(e.username)),"\n        </div>\n      </div>\n    </div>\n  ")},f.prototype.formatSelection=function(e){return i.a.escape(e.name)},f.prototype.user=function(e,t){if(!/^\d+$/.test(e))return!1;var a=this.buildUrl(this.userPath);return a=a.replace(":id",e),l.a.get(a).then((function(e){var a=e.data;t(a)}))},f.prototype.users=function(e,t,a){var s=this.buildUrl(this.usersPath),n={search:e,active:!0,project_id:t.projectId||null,group_id:t.groupId||null,skip_ldap:t.skipLdap||null,todo_filter:t.todoFilter||null,todo_state_filter:t.todoStateFilter||null,current_user:t.showCurrentUser||null,author_id:t.authorId||null,skip_users:t.skipUsers||null};return"merge_request"===t.issuableType&&(n.merge_request_iid=t.iid||null),l.a.get(s,{params:n}).then((function(e){var t=e.data;a(t)}))},f.prototype.buildUrl=function(e){return null!=gon.relative_url_root&&(e=gon.relative_url_root.replace(/\/$/,"")+e),e},f.prototype.renderRow=function(e,t,a,s,n){var r="merge_request"!==e||t.can_merge?"":Object(u.a)("Cannot merge"),l=r?"has-tooltip":"",o="".concat(!0===a?"is-active":""," ").concat(l),d=r?'data-container="body" data-placement="left" data-title="'.concat(r,'"'):"";return"\n    <li data-user-id=".concat(t.id,'>\n      <a href="#" class="dropdown-menu-user-link d-flex align-items-center ').concat(o,'" ').concat(d,">\n        ").concat(this.renderRowAvatar(e,t,n),'\n        <span class="d-flex flex-column overflow-hidden">\n          <strong class="dropdown-menu-user-full-name">\n            ').concat(i.a.escape(t.name),"\n          </strong>\n          ").concat(s?'<span class="dropdown-menu-user-username">'.concat(s,"</span>"):"","\n        </span>\n      </a>\n    </li>\n  ")},f.prototype.renderRowAvatar=function(e,t,a){if(t.beforeDivider)return a;var s="merge_request"!==e||t.can_merge?"":'<i class="fa fa-exclamation-triangle merge-icon"></i>';return'<span class="position-relative mr-2">\n    '.concat(a,"\n    ").concat(s,"\n  </span>")},t.a=f}}]);
//# sourceMappingURL=commons~pages.admin.abuse_reports~pages.admin.groups.show~pages.dashboard.todos.index~pages.groups.g~f5106b79.afd36d57.chunk.js.map